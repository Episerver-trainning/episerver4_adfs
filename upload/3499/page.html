<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 11 (filtered)">
<title> </title>

<style id="dynCom" type="text/css"><!-- --></style>
<script language="JavaScript"><!--
function msoCommentShow(anchor_id, com_id)
{
	if(msoBrowserCheck()) 
		{
		c = document.all(com_id);
		a = document.all(anchor_id);
		if (null != c && null == c.length && null != a && null == a.length)
			{
			var cw = c.offsetWidth;
			var ch = c.offsetHeight;
			var aw = a.offsetWidth;
			var ah = a.offsetHeight;
			var x  = a.offsetLeft;
			var y  = a.offsetTop;
			var el = a;
			while (el.tagName != "BODY") 
				{
				el = el.offsetParent;
				x = x + el.offsetLeft;
				y = y + el.offsetTop;
				}
			var bw = document.body.clientWidth;
			var bh = document.body.clientHeight;
			var bsl = document.body.scrollLeft;
			var bst = document.body.scrollTop;
			if (x + cw + ah / 2 > bw + bsl && x + aw - ah / 2 - cw >= bsl ) 
				{ c.style.left = x + aw - ah / 2 - cw; }
			else 
				{ c.style.left = x + ah / 2; }
			if (y + ch + ah / 2 > bh + bst && y + ah / 2 - ch >= bst ) 
				{ c.style.top = y + ah / 2 - ch; }
			else 
				{ c.style.top = y + ah / 2; }
			c.style.visibility = "visible";
}	}	}
function msoCommentHide(com_id) 
{
	if(msoBrowserCheck())
		{
		c = document.all(com_id);
		if (null != c && null == c.length)
		{
		c.style.visibility = "hidden";
		c.style.left = -1000;
		c.style.top = -1000;
		} } 
}
function msoBrowserCheck()
{
	ms = navigator.appVersion.indexOf("MSIE");
	vers = navigator.appVersion.substring(ms + 5, ms + 6);
	ie4 = (ms > 0) && (parseInt(vers) >= 4);
	return ie4;
}
if (msoBrowserCheck())
{
	document.styleSheets.dynCom.addRule(".msocomanchor","background: infobackground");
	document.styleSheets.dynCom.addRule(".msocomoff","display: none");
	document.styleSheets.dynCom.addRule(".msocomtxt","visibility: hidden");
	document.styleSheets.dynCom.addRule(".msocomtxt","position: absolute");
	document.styleSheets.dynCom.addRule(".msocomtxt","top: -1000");
	document.styleSheets.dynCom.addRule(".msocomtxt","left: -1000");
	document.styleSheets.dynCom.addRule(".msocomtxt","width: 33%");
	document.styleSheets.dynCom.addRule(".msocomtxt","background: infobackground");
	document.styleSheets.dynCom.addRule(".msocomtxt","color: infotext");
	document.styleSheets.dynCom.addRule(".msocomtxt","border-top: 1pt solid threedlightshadow");
	document.styleSheets.dynCom.addRule(".msocomtxt","border-right: 2pt solid threedshadow");
	document.styleSheets.dynCom.addRule(".msocomtxt","border-bottom: 2pt solid threedshadow");
	document.styleSheets.dynCom.addRule(".msocomtxt","border-left: 1pt solid threedlightshadow");
	document.styleSheets.dynCom.addRule(".msocomtxt","padding: 3pt 3pt 3pt 3pt");
	document.styleSheets.dynCom.addRule(".msocomtxt","z-index: 100");
}
// --></script>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	line-height:14.0pt;
	font-size:10.0pt;
	font-family:Helvetica;}
h1
	{margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:Helvetica;}
h2
	{margin-top:18.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	line-height:14.0pt;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:Helvetica;
	letter-spacing:.3pt;}
h3
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	line-height:14.0pt;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:Helvetica;
	letter-spacing:.3pt;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	line-height:14.0pt;
	font-size:10.0pt;
	font-family:Helvetica;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:10.0pt;
	line-height:14.0pt;
	font-size:10.0pt;
	font-family:Helvetica;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:20.0pt;
	line-height:14.0pt;
	font-size:10.0pt;
	font-family:Helvetica;}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	line-height:14.0pt;
	font-size:10.0pt;
	font-family:Helvetica;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	line-height:14.0pt;
	font-size:10.0pt;
	font-family:Helvetica;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:9.5pt;
	font-size:7.0pt;
	font-family:Helvetica;
	color:#5587B7;
	letter-spacing:1.1pt;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	line-height:14.0pt;
	font-size:8.0pt;
	font-family:Helvetica;
	font-style:italic;}
span.MsoPageNumber
	{font-family:Helvetica;}
p.MsoListBullet, li.MsoListBullet, div.MsoListBullet
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:36.85pt;
	text-indent:-22.65pt;
	line-height:14.0pt;
	font-size:10.0pt;
	font-family:Helvetica;}
p.MsoListNumber, li.MsoListNumber, div.MsoListNumber
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:36.85pt;
	text-indent:-14.15pt;
	line-height:14.0pt;
	font-size:10.0pt;
	font-family:Helvetica;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	line-height:14.0pt;
	font-size:10.0pt;
	font-family:Helvetica;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	line-height:14.0pt;
	font-size:10.0pt;
	font-family:Helvetica;
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	line-height:14.0pt;
	font-size:8.0pt;
	font-family:Tahoma;}
p.Heading, li.Heading, div.Heading
	{margin-top:48.0pt;
	margin-right:0cm;
	margin-bottom:48.0pt;
	margin-left:-1.0cm;
	font-size:28.0pt;
	font-family:Helvetica;
	letter-spacing:.4pt;}
p.HeadingCxSpFirst, li.HeadingCxSpFirst, div.HeadingCxSpFirst
	{margin-top:48.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:-1.0cm;
	margin-bottom:.0001pt;
	font-size:28.0pt;
	font-family:Helvetica;
	letter-spacing:.4pt;}
p.HeadingCxSpMiddle, li.HeadingCxSpMiddle, div.HeadingCxSpMiddle
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:-1.0cm;
	margin-bottom:.0001pt;
	font-size:28.0pt;
	font-family:Helvetica;
	letter-spacing:.4pt;}
p.HeadingCxSpLast, li.HeadingCxSpLast, div.HeadingCxSpLast
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:48.0pt;
	margin-left:-1.0cm;
	font-size:28.0pt;
	font-family:Helvetica;
	letter-spacing:.4pt;}
p.Tabelltext, li.Tabelltext, div.Tabelltext
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:Helvetica;}
p.Bild, li.Bild, div.Bild
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.0pt;
	font-family:Helvetica;}
span.SidfotChar
	{font-family:Helvetica;
	color:#5587B7;
	letter-spacing:1.8pt;}
 /* Page Definitions */
 @page Section1
	{size:21.0cm 842.0pt;
	margin:119.35pt 70.9pt 3.0cm 70.9pt;}
div.Section1
	{page:Section1;}
@page Section2
	{size:21.0cm 842.0pt;
	margin:119.35pt 70.9pt 3.0cm 70.9pt;}
div.Section2
	{page:Section2;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=EN-GB link=blue vlink=purple>

<div class=Section1>

<p class=Heading style='margin-left:0cm'>EPiServer SharePoint Connector</p>

<h1>Abstract</h1>

<p class=MsoBodyText><a name="_Toc59869223">An increasing amount of customers
want to build a solution based on EPiServer using functionality provided by Windows
SharePoint Services. This white paper describes some of the possibilities that
are available, the techniques that can be used, and presents a basic
implementation scenario. The intention is to give the reader new ideas and to
present a sample kit that could be used as a base in an EPiServer/SharePoint
integration project. </a></p>

</div>

<span style='font-size:10.0pt;font-family:Helvetica'><br clear=all
style='page-break-before:auto'>
</span>

<div class=Section2>

<p class=MsoBodyText>&nbsp;</p>

<h1 style='page-break-before:always'><a name="_Toc59869224">Building Solutions
on EPiServer and SharePoint</a></h1>

<h2>Intranet Requirements</h2>

<p class=MsoBodyText>A company or organisation building an intranet normally
has some basic requirements. Firstly the employees should have a common place
where they can find all company information and news. They need a simple, but
dynamic, way to add and modify information and they want to organise the
information in a structured way.</p>

<p class=MsoBodyText>Some companies also have an extended need for workgroups
to collaborate within the company, especially when it comes to sharing
documents within the group. </p>

<p class=MsoBodyText>If the company uses a Windows SharePoint Services-based
(WSS) solution, it will, after a while, contain a large amount of different Web
sites or “working areas”. This may result in a SharePoint user having
difficulty navigating in the solution or even “getting lost”. This scenario
requires a structure of all the different Web sites and an easy way of
navigating between them.</p>

<p class=MsoBodyText>Integrating EPiServer and SharePoint may introduce another
user requirement – to have the possibility to also view selected information
from the intranet inside the WSS part of the system.</p>

<p class=Bild><img width=284 height=186 src="/upload/3499/image001.jpg">         
<img width=239 height=185 src="/upload/3499/image002.jpg"></p>

<h2><a name="_Toc59869226">The Solution</a></h2>

<p class=MsoBodyText>To handle your basic intranet requirements, you would
probably select a Content Management System. A Content Management System like
EPiServer has long been a perfect solution to fulfil this need. All company
information can be handled with its clear information structure and powerful
environment for the editors.</p>

<p class=MsoBodyText>The day-to day document handling or team collaboration
could be managed by building a customised “working area” into the EPiServer
solution. Another way is to add the functionality using Windows SharePoint
Services. By mixing the two products, you can achieve a flexible and
cost-effective solution.</p>

<p class=MsoBodyText>To get organized in WSS you can choose to use SharePoint
Portal Server. Another interesting solution is to use EPiServer to provide
support for navigation and to add a structure to the sites in WSS. If you use
this kind of functionality from EPiServer and provide it in SharePoint, you can
really get organized.</p>

<p class=MsoBodyText>Finally, to fulfil the need for users to see EPiServer
information inside WSS you would probably add this functionality using
EPiServer WebParts.</p>

<h1 style='page-break-before:always'><a name="_Toc59869227">The Integration -
Technical Overview</a></h1>

<p class=MsoNormal>There are several ways of integrating EPiServer and
SharePoint. In our Connector package we provide two separate solutions. The
first solution is built on the need an EPiServer user has for content and
functionality in SharePoint. We have added an SP File System and some
SharePoint Integration templates into EPiServer. Data is delivered using a Web
Service running under the SharePoint application. The Authentication Listener
is added to make it possible to be authenticated in SharePoint using the same
user identity as used in EPiServer.</p>

<p class=Bild><img width=599 height=387 src="/upload/3499/image003.jpg"></p>

<p class=MsoBodyText>The second method we use in the SharePoint part of the
sample set is by running the EPiServer SharePoint Connector (EPiServerProxy) in
the same application as SharePoint. EPiServerProxy then accesses data using a
Web Service. This method gives us the benefits of reaching functionality in
both EPiServer and SharePoint at the same time. EPiServerProxy does not provide
all functionality in EPiServer, but gives enough support to fetch data and add
data to EPiServer.</p>

<p class=Bild><img width=599 height=357 src="/upload/3499/image004.jpg"></p>

<h1 style='page-break-before:always'><a name="_Toc59869228">Add SharePoint
Functionality to EPiServer</a></h1>

<p class=MsoBodyText>In the solution built on EPiServer and WSS, the users will
probably use WSS to organise their documents. When the user is working in the
EPiServer part of the solution, he or she can then hook in to the document
store in SharePoint. Using Open Development Architecture (ODA) in EPiServer,
the Link Tool can be extended. The extension will give the user a new folder
choice in the Link Tool, which provides access to documents in SharePoint.</p>

<p class=MsoBodyText>Below is a sample of the file system and Link Tool showing
content from SharePoint.</p>

<p class=Bild align=left style='text-align:left'><img width=295 height=419
src="/upload/3499/image005.jpg"></p>

<p class=Bild>&nbsp;</p>

<p class=Bild>&nbsp;</p>

<p class=Bild align=left style='text-align:left'><img width=449 height=349
src="/upload/3499/image006.jpg"></p>

<h2><a name="_Toc70846968">SP Overview</a></h2>

<p class=MsoNormal>The sample template SP Overview in EPiServer makes it
possible to obtain a structured overview over the Webs and sites in the
SharePoint environment. In the sample implementation, the user can obtain a
complete list of sites and he or she can also open the corresponding site (in
an IFRAME) by clicking the list. The user will only see the sites he or she has
access to.</p>

<p class=Bild align=left style='text-align:left'><img width=382 height=260
src="/upload/3499/image007.jpg"></p>

<h2><a name="_Toc70846969">SP Integrated Project</a></h2>

<p class=MsoBodyText>In many cases a user needs an overview of material and
information connected to a specific project. The problem is that the
information can be spread around in many different systems. The sample template
SP Integrated Project shows how this information can be gathered together and
reached from one point.</p>

<p class=Bild align=left style='text-align:left'><img width=387 height=298
src="/upload/3499/image008.jpg"></p>

<p class=MsoBodyText>Each project is based on a page in EPiServer. When you
edit the page, you can set up the site that the project is connected to and which
document folder files should be listed from.</p>

<p class=Bild align=left style='text-align:left'><img width=258 height=307
src="/upload/3499/image009.jpg"></p>

<h1 style='page-break-before:always'><a name="_Toc59869229">Add EPiServer
Functionality to SharePoint</a> </h1>

<h2><a name="_Toc59869230">EPiServer WebParts</a></h2>

<p class=MsoBodyText>The most obvious method of adding EPiServer functionality
and EPiServer content into SharePoint is by using one or more WebParts.
Important information and navigation from EPiServer can be shown in the
SharePoint environment.</p>

<p class=Bild align=left style='text-align:left'><img width=388 height=280
src="/upload/3499/image010.jpg"></p>

<p class=MsoBodyText>Connected to this white paper we have developed a sample
set of WebParts that can provide the most common information from EPiServer.
These WebParts are described below.</p>

<h3><a name="_Toc59869231">WebPart - EPiServer PageList</a></h3>

<p class=MsoBodyText><span lang=EN-US>An EPiServer PageList WebPart is a WebPart
that takes a given point of the structure in EPiServer and displays it as a
list in SharePoint. This WebPart is a typical information viewer and shows the
SharePoint user-selected information from the EPiServer-based Web. It can show
all kinds of information, but will normally show news or other dynamic
information.</span></p>

<p class=MsoBodyText><span lang=EN-US>From EPiServer PageList WebPart it is
possible to connect to other WebParts (PageData and PageView), so that when a
user clicks an item in the list, another WebPart will be updated to display the
requested information.</span></p>

<p class=Bild align=left style='text-align:left'><img width=575 height=236
src="/upload/3499/image011.gif"></p>

<h3><a name="_Toc59869232">WebPart - EPiServer PageData</a></h3>

<p class=MsoBodyText><span lang=EN-US>The EPiServer PageData WebPart will
display content from a given page in EPiServer. The PageData WebPart is used
when you want to use the existing design within SharePoint and only want to
display the most frequently used properties (Title and MainBody) within
EPiServer pages. EPiServer PageData supports Connections. See below for further
information about connections.</span></p>

<p class=Bild align=left style='text-align:left'><img width=573 height=245
src="/upload/3499/image012.gif"></p>

<h3><a name="_Toc59869234">WebPart - </a><span lang=EN-US>EPiServer Bread </span>Crumb
(Site Organizer)</h3>

<p class=MsoBodyText><span lang=EN-US>The EPiServer Bread Crumb WebPart is used
to display SharePoint paths stored in EPiServer. Using this WebPart you can add
a reference to all created SharePoint subsites into an EPiServer structure and </span>organise<span
lang=EN-US> them in a well-managed way. </span>Basically,<span lang=EN-US> a
solution built on this WebPart, together with a third-party search engine like
MondoSearch, gives the customer all the support they need to create a complete
EPiServer/WSS-based intranet.</span></p>

<p class=Bild align=left style='text-align:left'><img width=247 height=205
src="/upload/3499/image013.jpg"></p>

<p class=Bild align=left style='text-align:left'><img width=252 height=15
src="/upload/3499/image014.jpg"></p>

<p class=Bild align=left style='text-align:left'><img width=334 height=53
src="/upload/3499/image015.jpg"></p>

<h2><a name="_Toc59869236">Connections</a></h2>

<p class=MsoBodyText><span lang=EN-US>The PageList, PageData and <a>PageView </a></span><span
class=MsoCommentReference><span style='font-size:8.0pt'><a class=msocomanchor
id="_anchor_1" onmouseover="msoCommentShow('_anchor_1','_com_1')"
onmouseout="msoCommentHide('_com_1')" href="#_msocom_1" language=JavaScript
name="_msoanchor_1">[HHA1]</a><span style='display:none'>&nbsp;</span></span></span><span
lang=EN-US>WebParts can all be connected to each other. When a user clicks a
page in the PageList, a PageData should be updated to show the content of the
page. This built-in functionality in SharePoint works very well when
implementing EPiServer functionality in to SharePoint.</span></p>

<p class=Bild align=left style='text-align:left'><img width=224 height=78
src="/upload/3499/image016.gif"></p>

<p class=Bild align=left style='text-align:left'><img width=376 height=126
src="/upload/3499/image017.jpg"></p>

<p class=Bild align=left style='text-align:left'><img width=236 height=156
src="/upload/3499/image018.jpg"></p>

<h2><a name="_Toc59869237"><span lang=EN-US>Searchability</span></a></h2>

<p class=MsoBodyText>Centralised search functionality is not included in the
samples provided. Windows SharePoint Services does not provide search support,
which makes it harder to provide one integrated search function. By using
SharePoint Portal Server, you can set up search functions based on crawler
functionality and this should make it possible to also include content from EPiServer
WebParts. Another solution is to use a third-party product like MondoSearch
from Mondosoft.</p>

<p class=MsoBodyText><span lang=EN-US>All content in EPiServer is always
searchable, which makes it easy to create a search function that searches
EPiServer content.</span></p>

<h2><a name="_Toc59869238"><span lang=EN-US>Authentication</span></a></h2>

<p class=MsoBodyText><span lang=EN-US>The solution described in this white
paper is based on a scenario where EPiServer runs under WSS. The easiest way to
set up the authentication mechanism is to use Windows Authentication on the
site.</span></p>

<p class=Bild align=left style='text-align:left'><img width=599 height=455
src="/upload/3499/image019.jpg"></p>

<p class=MsoNormal><span lang=EN-US>In the web.config file in the EPiServer
application, it is possible to add a “master user”. This account is used if the
SP File System should display all Virtual Servers on the WSS. If only one
specific Virtual Server will be accessed, the account will not be necessary. </span></p>

<h1 style='page-break-before:always'><a name="_Toc59869239">The Next Step</a></h1>

<p class=MsoBodyText>Together with this white paper there are some samples that
could be used as a platform for developers building EPiServer/SharePoint
integration. The best next step to take is to gain access to the samples and
see the possibilities that they reveal.</p>

</div>

<div>

<hr class=msocomoff align=left size=1 width="33%">

<div>

<div id="_com_1" class=msocomtxt language=JavaScript
onmouseover="msoCommentShow('_anchor_1','_com_1')"
onmouseout="msoCommentHide('_com_1')"><a name="_msocom_1"></a>

<p class=MsoCommentText><span class=MsoCommentReference><span style='font-size:
8.0pt'>&nbsp;<a href="#_msoanchor_1" class=msocomoff>[HHA1]</a></span></span><span
lang=SV>PageView är inte med I dokumentet annars. Behövs ny bil?</span></p>

</div>

</div>

</div>

</body>

</html>
